<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Professioneel Dartspel</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1b1b1b;
            color: #f5f5f5;
            text-align: center;
            margin: 20px;
        }
        canvas {
            background-color: #000;
            border-radius: 50%;
            border: 2px solid #fff;
            margin-top: 20px;
        }
        button, select {
            padding: 10px 20px;
            margin: 10px;
            font-size: 16px;
            border-radius: 8px;
            border: none;
            background-color: #444;
            color: #fff;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Professioneel Dartspel - 501</h1>
    <div>
        <label for="players">Aantal spelers: </label>
        <select id="players">
            <option value="1">1</option>
            <option value="2" selected>2</option>
            <option value="3">3</option>
            <option value="4">4</option>
        </select>
        <button onclick="startGame()">Start spel</button>
    </div>

    <div id="scoreboard" style="display:none;">
        <h2>Beurt: <span id="currentPlayer">Speler 1</span></h2>
        <div id="scores"></div>
        <p>Laatste worp: <span id="lastThrow">-</span></p>
    </div>

    <canvas id="dartboard" width="500" height="500" style="display:none;"></canvas>

    <script>
        const sectors = [20, 1, 18, 4, 13, 6, 10, 15, 2, 17, 3, 19, 7, 16, 8, 11, 14, 9, 12, 5];
        let numPlayers = 2;
        let scores = [];
        let currentPlayer = 0;
        let gameActive = false;

        const canvas = document.getElementById("dartboard");
        const ctx = canvas.getContext("2d");

        function startGame() {
            numPlayers = parseInt(document.getElementById("players").value);
            scores = Array(numPlayers).fill(501);
            currentPlayer = 0;
            gameActive = true;
            document.getElementById("scoreboard").style.display = "block";
            document.getElementById("dartboard").style.display = "block";
            drawBoard();
            updateScores();
        }

        function updateScores() {
            document.getElementById("currentPlayer").innerText = "Speler " + (currentPlayer + 1);
            let html = "";
            scores.forEach((s, i) => {
                html += `<p>Speler ${i+1} score: ${s}</p>`;
            });
            document.getElementById("scores").innerHTML = html;
        }

        function drawBoard() {
            ctx.clearRect(0, 0, 500, 500);
            const centerX = 250, centerY = 250;

            // Teken sectoren
            for (let i = 0; i < 20; i++) {
                let start = (i * 18 - 9) * Math.PI/180;
                let end = ((i+1) * 18 - 9) * Math.PI/180;

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, 250, start, end);
                ctx.fillStyle = i % 2 === 0 ? "#222" : "#fff";
                ctx.fill();

                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, 210, start, end);
                ctx.fillStyle = i % 2 === 0 ? "#fff" : "#222";
                ctx.fill();
            }

            // Triple ring
            ctx.beginPath(); ctx.arc(centerX, centerY, 170, 0, 2 * Math.PI); ctx.fillStyle = "#000"; ctx.fill();
            ctx.beginPath(); ctx.arc(centerX, centerY, 190, 0, 2 * Math.PI); ctx.fillStyle = "transparent"; ctx.strokeStyle="#333"; ctx.stroke();

            // Double ring
            ctx.beginPath(); ctx.arc(centerX, centerY, 230, 0, 2 * Math.PI); ctx.fillStyle = "#000"; ctx.fill();
            ctx.beginPath(); ctx.arc(centerX, centerY, 250, 0, 2 * Math.PI); ctx.fillStyle = "transparent"; ctx.strokeStyle="#333"; ctx.stroke();

            // Bull en bullseye
            ctx.beginPath(); ctx.arc(centerX, centerY, 25, 0, 2 * Math.PI); ctx.fillStyle = "#0f0"; ctx.fill();
            ctx.beginPath(); ctx.arc(centerX, centerY, 10, 0, 2 * Math.PI); ctx.fillStyle = "#f00"; ctx.fill();
        }

        canvas.addEventListener("click", function(e) {
            if (!gameActive) return;
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left - 250;
            const y = e.clientY - rect.top - 250;
            const distance = Math.sqrt(x*x + y*y);
            let angle = Math.atan2(-y, x) * 180 / Math.PI;
            if (angle < 0) angle += 360;
            let sectorIndex = Math.floor((angle + 9) / 18) % 20;
            let baseScore = sectors[sectorIndex];
            let multiplier = 1;

            if (distance <= 10) { baseScore = 50; multiplier = 1; }
            else if (distance <= 25) { baseScore = 25; multiplier = 1; }
            else if (distance >= 230) multiplier = 2; // double ring
            else if (distance >= 170 && distance <= 190) multiplier = 3; // triple ring

            let throwScore = baseScore * multiplier;
            document.getElementById("lastThrow").innerText = `${baseScore} x${multiplier} = ${throwScore}`;

            // double-out check
            let newScore = scores[currentPlayer] - throwScore;
            if (newScore < 0) {
                alert("Bust! Je score gaat terug naar begin van deze beurt.");
            } else if (newScore === 0) {
                if (multiplier === 2 || baseScore === 50) {
                    alert("Speler " + (currentPlayer + 1) + " wint!");
                    gameActive = false;
                    return;
                } else {
                    alert("Je moet uitgooien op een dubbel!");
                }
            } else {
                scores[currentPlayer] = newScore;
                currentPlayer = (currentPlayer + 1) % numPlayers;
            }
            updateScores();
        });
    </script>
</body>
</html>
